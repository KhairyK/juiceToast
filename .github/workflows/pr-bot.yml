name: PR Bot

on:
  pull_request:
    types: [opened, reopened]

permissions:
  pull-requests: write
  issues: write
  contents: read

jobs:
  triage:
    runs-on: ubuntu-latest
    steps:
      - name: Auto assign maintainer
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.addAssignees({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.payload.pull_request.number,
              assignees: ["KhairyK"]
            })

      - name: Auto label PR
        uses: actions/github-script@v7
        with:
          script: |
            const title = context.payload.pull_request.title.toLowerCase();
            const labels = [];

            if (title.includes("fix")) labels.push("bug");
            if (title.includes("feat") || title.includes("feature")) labels.push("feature");
            if (title.includes("docs")) labels.push("documentation");
            if (title.includes("refactor")) labels.push("refactor");
            if (title.includes("chore")) labels.push("chore");
            if (title.includes("test")) labels.push("tests");
            if (title.includes("deps") || title.includes("dependabot")) labels.push("dependencies");

            if (labels.length > 0) {
              github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.payload.pull_request.number,
                labels
              });
            }

      - name: Comment on PR
        uses: actions/github-script@v7
        with:
          script: |
            const body = `
ğŸ‘‹ **Hello and welcome to JuiceToast!**

First of all, thank you so much for taking the time to contribute. Your PR has been successfully received and is now under review.

---

### Whatâ€™s happening now?
- âœ… **Maintainer Assignment:** This PR has been automatically assigned to a maintainer.
- ğŸ·ï¸ **Labeling:** Based on the title, relevant labels have been added.
- ğŸ” **Review:** Weâ€™ll carefully review your changes and provide feedback.

---

### Contribution Tips
- Keep your changes focused and clear.
- Document your code properly; comments are appreciated!
- Avoid breaking backward compatibility.
- If your PR fixes an issue, please reference it explicitly (e.g., "Fixes #123").
- Tests are highly appreciated for new features or bug fixes.
- Be patient â€” reviews may take some time depending on the workload.

---

### Community & Support
We love collaboration! Feel free to discuss your PR, ask questions, or suggest improvements. Every contribution, big or small, makes JuiceToast better ğŸ¹.

---

**Thanks again for your effort â€” happy coding and keep rocking!** ğŸš€ğŸ’™
`;

            github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.payload.pull_request.number,
              body
            });