/**
 * 2026 (C) OpenDN Foundation
 * v1.2.0-rc.2026 Juice Toast
 * ESM (ECMAScript Module (import/export))
 */
let isBrowser="undefined"!=typeof window&&"undefined"!=typeof document,themes={light:{bg:"#ffffff",color:"#111",border:"1px solid #e5e7eb"},dark:{bg:"#1f2937",color:"#fff",border:"1px solid rgba(255,255,255,.08)"}},sizePreset={sm:{width:"260px",padding:"10px"},md:{width:"320px",padding:"14px"},lg:{width:"420px",padding:"18px"}},juiceToast={_config:{},_queue:[],_showing:!1,_theme:"dark",setup(e={}){this._config=e,this._defaults={...this._defaults,...e},this._registerTypes()},addType(e,t={}){this._config[e]=t,this._registerTypes()},defineTheme(e,t={}){themes[e]={...themes[e]||{},...t}},setTheme(e){if(this._theme=e,!isBrowser)return;let t=document.getElementById("juice-toast-root");t&&(t.dataset.theme=e)},clear(){this._queue.length=0},destroy(){this.clear(),isBrowser&&document.getElementById("juice-toast-root")?.remove()},_registerTypes(){Object.keys(this._config).forEach(e=>{if("function"==typeof this[e]&&!this[e].__auto)return;let t=t=>this._enqueue(e,t);t.__auto=!0,this[e]=t})},_enqueue(e,t){this._queue.push({type:e,payload:t}),this._showing||this._next()},_next(){if(!this._queue.length){this._showing=!1;return}this._showing=!0;let e=this._queue.shift();this._showToast(e.type,e.payload)},_normalizeGlass(e){if(!0===e)return 60;if(!1===e||null==e)return 0;let t=Number(e);return Number.isFinite(t)?Math.max(0,Math.min(100,t)):0},_getRoot(e="bottom-right"){if(!isBrowser)return null;let t=document.getElementById(`juice-toast-root-${e}`);if(!t){switch((t=document.createElement("div")).id=`juice-toast-root-${e}`,t.dataset.position=e,t.dataset.theme=this._theme,t.style.position="fixed",t.style.zIndex=9999,e){case"top-left":t.style.top="20px",t.style.left="20px";break;case"top-right":t.style.top="20px",t.style.right="20px";break;case"bottom-left":t.style.bottom="20px",t.style.left="20px";break;case"bottom-right":t.style.bottom="20px",t.style.right="20px";break;case"top-center":t.style.top="20px",t.style.left="50%",t.style.transform="translateX(-50%)";break;case"bottom-center":t.style.bottom="20px",t.style.left="50%",t.style.transform="translateX(-50%)"}document.body.appendChild(t)}return t},_defaults:{duration:2500,maxVisible:3,swipeThreshold:60,glassUI:0,playSound:null},_playSound(e){if(!isBrowser)return;let t="string"==typeof e&&e?e:this._defaults.playSound;if(t)try{let s=new Audio(t);s.volume=.6,s.play().catch(()=>{})}catch{}},_showToast(e,t){if(!isBrowser)return;let s=this._config[e]||{},i="object"==typeof t?t:{message:String(t)},o={...s,...i};o.icon=o.icon??o.icon_left_top,o.iconPack=o.iconPack??o.icon_config,o.iconLink=o.iconLink??o.icon_onClick_url,o.iconAnimate=o.iconAnimate??o.icon_onClick_animate,o.position=o.position??o.toast,o.closable=o.closable??o.closeable,o.iconPosition=o.iconPosition||"left",o.compact=!!o.compact;let n=themes[o.theme||this._theme]||{},a=document.createElement("div");a.className="juice-toast";let l=o.animation||"slide-in";if(a.style.animation=`${l} 0.4s ease forwards`,a.setAttribute("role","alert"),a.setAttribute("aria-live","polite"),a.tabIndex=0,o.size&&sizePreset[o.size]){let r=sizePreset[o.size];r.width&&(a.style.width=r.width),r.padding&&(a.style.padding=r.padding)}let d=this._normalizeGlass(o.glassUI??this._defaults.glassUI);d>0&&(a.classList.add("jt-glass"),a.style.setProperty("--jt-glass",d)),d||(a.style.background=o.bg||n.bg),a.style.color=o.color||n.color,a.style.border=o.border||n.border,o.compact&&a.classList.add("jt-compact"),(o.glassUI??this._defaults.glassUI)&&a.classList.add("jt-glass"),o.width&&(a.style.width=o.width),o.height&&(a.style.height=o.height);let c=null;o.icon&&((c=document.createElement("i")).className=["icon",o.iconPack||"",o.icon].join(" ").trim(),o.iconSize&&(c.style.fontSize=o.iconSize),(o.iconLink||o.iconAnimate)&&(c.classList.add("icon-clickable"),c.onclick=e=>{e.stopPropagation(),o.iconAnimate&&(c.classList.remove(o.iconAnimate),c.offsetWidth,c.classList.add(o.iconAnimate)),o.iconLink&&window.open(o.iconLink,"_blank","noopener")}));let h=0,p=0;a.addEventListener("touchstart",e=>{h=e.touches[0].clientX}),a.addEventListener("touchmove",e=>{p=e.touches[0].clientX-h,a.style.transform=`translateX(${p}px)`}),a.addEventListener("touchend",()=>{Math.abs(p)>this._defaults.swipeThreshold?(a.style.transform=`translateX(${p>0?1e3:-1e3}px)`,setTimeout(()=>{a.remove(),this._next()},200)):a.style.transform="",h=p=0});let m=document.createElement("div");if(m.className="jt-content",o.title){let u=document.createElement("div");u.className="jt-title",u.textContent=o.title,m.appendChild(u)}let f=document.createElement("div");if(f.className="jt-message",f.textContent=o.message||"",m.appendChild(f),c&&"top"===o.iconPosition?(a.classList.add("jt-icon-top"),a.appendChild(c),a.appendChild(m)):c&&"right"===o.iconPosition?(a.appendChild(m),a.appendChild(c)):(c&&a.appendChild(c),a.appendChild(m)),Array.isArray(o.actions)&&o.actions.length){let g=document.createElement("div");g.className="jt-actions",o.actions.forEach(e=>{let t=document.createElement("button");t.className="jt-action",t.textContent=e.label,t.onclick=t=>{t.stopPropagation(),e.onClick?.(t),e.closeOnClick&&(a.remove(),this._next())},g.appendChild(t)}),m.appendChild(g)}if(o.closable){let $=document.createElement("span");$.className="juice-toast-close",$.innerHTML="\xd7",$.onclick=()=>{a.remove(),this._next()},a.appendChild($)}let y=this._getRoot(o.position),b=this._defaults.maxVisible;b&&y.children.length>=b&&y.firstChild.remove(),y.appendChild(a),requestAnimationFrame(()=>a.classList.add("show"));let x=o.duration??2500;if(0===x)return;let w=Date.now(),k=o.duration??this._defaults.duration,v,L=()=>{if(a.__paused)w=Date.now();else{let e=Date.now();k-=e-w,w=e}k<=0?(a.classList.remove("show"),setTimeout(()=>{a.remove(),this._next()},300)):v=requestAnimationFrame(L)};a.addEventListener("mouseenter",()=>a.__paused=!0),a.addEventListener("mouseleave",()=>a.__paused=!1),a.addEventListener("touchstart",()=>a.__paused=!0),a.addEventListener("touchend",()=>a.__paused=!1),requestAnimationFrame(L)}};export default juiceToast;export{juiceToast};